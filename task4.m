a=5;
b=4;
c=5;
d=2;
X0=[0.5;-0.1;0.3;-0.8];
A=[-8.8487+(a-b)/5, -0.0399, -5.55+(c+d)/10, 3.5846;
   -4.5740, 2.5010*((d+5)/(c+5)), -4.3662, -1.1183-(a-c)/20;
   3.7698, 16.1212-c/5, -18.2103+(a+d)/(b+4), 4.4936;
   -8.5645-(a-b)/(c+d+2), 8.3742, -4.4331, -7.7181*(c+5)/(b+5)];
B=[0.0564+b/(10+c), 0.0319;
   0.0165-(c+d-5)/(1000+20*a), -0.02;
   4.4939, 1.5985*(a+10)/(b+12);
   -1.4269, -0.2730];
C=[-3.2988,-2.1932+(10*c+d)/(100+5*a), 0.0370, -0.0109;
   0.2922- a*b/500, -2.150, -0.0104, 0.0163];
D=[0,0;0,0];
c1T = C(1,:);
c2T = C(2,:);
sigma1 = 4;
sigma2 = 4;
for j = 1:4
    if c1T*(A^(j-1))*B ~= 0 
        sigma1 = j;
        break
    end
end
for j = 1:4
    if c2T*(A^(j-1))*B ~= 0 
        sigma2 = j;
        break
    end
end
Bstar=[c1T*(A^(sigma1-1))*B;
       c2T*(A^(sigma2-1))*B];
Cstar=[c1T*(A^(sigma1));
       c2T*(A^(sigma2))];
Cstarstar = [c1T*(A+eye(4));c2T*(A+2*eye(4))];
F = inv(Bstar);
K = (inv(Bstar))*Cstarstar;
ans1 = eig(A);
ans2 = eig(A-B*K);
D=[0,0;0,0];
sys = tf(ss(A-B*K,B*F,C,D))
%[b1,a1] = ss2tf(A-B*K,(B*F),C,D,1);
%b1=b1(1,:);
%sys1 = tf(b1,a1);
%tf(sys1);
%[b2,a2] = ss2tf(A-B*K,(B*F),C,D,2);
%b2=b2(2,:);
%sys2 = tf(b2,a2);




